import pandas as pd
from datetime import datetime

NUM_DAY_YEAR = 252
SAMPLE_NB = 50000
FINIT_DIF_STEP = 0.01

PRICES = pd.read_csv('src/data/prices_data.csv', index_col=0)
RATES = pd.read_csv('src/data/rates_data.csv', index_col=0)
COVS = pd.read_csv('src/data/covariance_data.csv', index_col=[0, 1])
CORRS = pd.read_csv('src/data/correlation_data.csv', index_col=[0, 1])
PRECOMPUTED_PRICINGS_1 = pd.read_csv('src/data/precomputed_pricings_1.csv', index_col=None)
PRECOMPUTED_PRICINGS_2 = pd.read_csv('src/data/precomputed_pricings_2.csv', index_col=None)
PRECOMPUTED_PRICINGS_3 = pd.read_csv('src/data/precomputed_pricings_3.csv', index_col=None)

# Convert index to datetime for PRICES
PRICES.index = pd.to_datetime(PRICES.index)

# Convert index to datetime for RATES
RATES.index = pd.to_datetime(RATES.index)

# Convert index levels to datetime for COVS
COVS.index = COVS.index.set_levels(pd.to_datetime(COVS.index.levels[0]), level=0)

# Convert index levels to datetime for CORRS
CORRS.index = CORRS.index.set_levels(pd.to_datetime(CORRS.index.levels[0]), level=0)

# Convert 'Date' column to datetime for PRECOMPUTED_PRICINGS
PRECOMPUTED_PRICINGS_1["Date"] = pd.to_datetime(PRECOMPUTED_PRICINGS_1["Date"])
PRECOMPUTED_PRICINGS_2["Date"] = pd.to_datetime(PRECOMPUTED_PRICINGS_2["Date"])
PRECOMPUTED_PRICINGS_3["Date"] = pd.to_datetime(PRECOMPUTED_PRICINGS_3["Date"])

raw_list_dates = CORRS.index.get_level_values('first') # pour l'instant. A raccourcir
raw_list_dates = list(set(PRICES.index) & set(RATES.index) & set(CORRS.index.get_level_values('first'))) # for now
raw_list_dates.sort()

STR_DATES_GRID_1 = ["05/07/2000", "03/07/2001", "02/07/2002", "02/07/2003", "02/07/2004", "05/07/2005"]
DATES_GRID_1 = [datetime.strptime(date_str, "%d/%m/%Y") for date_str in STR_DATES_GRID_1]
LIST_DATES_1 = [date for date in raw_list_dates if DATES_GRID_1[0] <= date <= DATES_GRID_1[-1]]
MATHS_DATES_GRID_1 = [LIST_DATES_1.index(date) / NUM_DAY_YEAR for date in DATES_GRID_1]

STR_DATES_GRID_2 = ["04/01/2005", "04/01/2006", "04/01/2007", "04/01/2008", "05/01/2009", "04/01/2010"]
DATES_GRID_2 = [datetime.strptime(date_str, "%d/%m/%Y") for date_str in STR_DATES_GRID_2]
LIST_DATES_2 = [date for date in raw_list_dates if DATES_GRID_2[0] <= date <= DATES_GRID_2[-1]]
MATHS_DATES_GRID_2 = [LIST_DATES_2.index(date) / NUM_DAY_YEAR for date in DATES_GRID_2]

STR_DATES_GRID_3 = ["05/01/2009", "04/01/2010", "04/01/2011", "04/01/2012", "04/01/2013", "06/01/2014"]
DATES_GRID_3 = [datetime.strptime(date_str, "%d/%m/%Y") for date_str in STR_DATES_GRID_3]
LIST_DATES_3 = [date for date in raw_list_dates if DATES_GRID_3[0] <= date <= DATES_GRID_3[-1]]
MATHS_DATES_GRID_3 = [LIST_DATES_3.index(date) / NUM_DAY_YEAR for date in DATES_GRID_3]

PAST_1 = [[6462.7,
  2050.7023297302976,
  3830.2025396159097,
  0.7503152161382367,
  0.617588414314199,
  1.04942806170637,
  0.0009399266114701],
 [5205.78,
  2102.616998703287,
  2148.013674407632,
  0.4893779545979303,
  0.609454202522692,
  1.17882824472474,
  0.0009124057621708],
 [3735.66,
  1836.36994929006,
  977.3427991886406,
  0.5922944739963639,
  0.571703853955375,
  1.01419878296146,
  0.0008516953165615],
 [3079.07,
  1789.283564493758,
  1079.8803744798893,
  0.46282470679073034,
  0.590152565880721,
  0.866851595006935,
  0.0007302262614833],
 [3685.06,
  2047.318626734843,
  1202.167031896762,
  0.5012032954831886,
  0.579254930606282,
  0.811622433244055,
  0.0007051454676316],
 [4252.75,
  2676.3465245130956,
  1264.5651443922095,
  0.7354376965877487,
  0.622145735392881,
  0.83948959032908,
  0.0008002760632307]]

PAST_2 = [[3863.3,
  2342.7939713639803,
  1184.4988696307457,
  0.5954947852007951,
  0.577241899020347,
  0.753579502637528,
  0.0007259918137163],
 [4838.52,
  2971.352473614776,
  1398.276715039578,
  1.0345348774808363,
  0.616424802110818,
  0.824538258575198,
  0.0008261078635158],
 [5574.56,
  3347.1235037835336,
  1370.4119850187262,
  1.0239754067909141,
  0.599327371397997,
  0.764350684093862,
  0.0008209996606808],
 [5446.79,
  3725.9871125279783,
  1331.8320558909315,
  1.1134131517280685,
  0.590788848945262,
  0.678288001085261,
  0.0007229673855097],
 [3359.92,
  1943.5075713025562,
  928.0505733607756,
  0.5772411340842372,
  0.527124375183769,
  0.735077918259335,
  0.0005615568512294],
 [4013.97,
  3087.657865519394,
  1309.2082437027277,
  0.8946603560921408,
  0.633196863507043,
  0.693914370966623,
  0.0006039289564548]]

PAST_3 = [[3359.92,
  1943.5075713025562,
  928.0505733607756,
  0.5772411340842372,
  0.527124375183769,
  0.735077918259335,
  0.0005615568512294],
 [4013.97,
  3087.657865519394,
  1309.2082437027277,
  0.8946603560921408,
  0.633196863507043,
  0.693914370966623,
  0.0006039289564548],
 [3916.03,
  3585.131757010752,
  1692.6997970077437,
  1.203913707823221,
  0.755958198631682,
  0.751823171190136,
  0.0006688818249022],
 [3193.65,
  3354.1235857805236,
  1800.3941267387936,
  1.069684870902901,
  0.800927357032457,
  0.772797527047913,
  0.0006735499429536],
 [3730.02,
  3787.860748450294,
  2085.0156883752966,
  1.2530096422666117,
  0.801867299303589,
  0.765286599831637,
  0.0007205138680697],
 [4227.54,
  3501.9999853232544,
  2588.2131063330157,
  1.1534917259804787,
  0.657664929918544,
  0.733837234901299,
  0.0006890425769723]]

PRECOMPUTED_PRICINGS = [PRECOMPUTED_PRICINGS_1, PRECOMPUTED_PRICINGS_2, PRECOMPUTED_PRICINGS_3]
STR_DATES_GRID = [STR_DATES_GRID_1, STR_DATES_GRID_2, STR_DATES_GRID_3]
DATES_GRID = [DATES_GRID_1, DATES_GRID_2, DATES_GRID_3]
LIST_DATES = [LIST_DATES_1, LIST_DATES_2, LIST_DATES_3]
MATHS_DATES_GRID = [MATHS_DATES_GRID_1, MATHS_DATES_GRID_2, MATHS_DATES_GRID_3]
PAST = [PAST_1, PAST_2, PAST_3]

INDEX_DICT = {"CAC40": "CAC", "ASX200": "ASX", "KOSPI50": "KOSPI", "NASDAQ100": "NASDAQ"}
SYMBOL_DICT = {"CAC40": "€", "ASX200": "AU$", "KOSPI50": "₩", "NASDAQ100": "$"} 
CURRENCIES_DICT = {"€": "EUR", "AU$": "AUD", "₩": "KRW", "$": "USD"}

ASSETS = list(PRICES.columns)
ASSETS.append("Cash (ZC Domestic in €)")
ASSETS[4] += " ZC"
ASSETS[5] += " ZC"
ASSETS[6] += " ZC"